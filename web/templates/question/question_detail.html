{% extends 'base.html' %}

{% block content %}
<div class="container my-3">

    <!-- flash ë©”ì‹œì§€ í‘œì‹œ -->
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="alert alert-danger" role="alert">
                {% for message in messages %}
                    {{ message }}
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    {% if question.is_secret and 'authorized_' ~ question.id not in session %}
        <!-- ë¹„ë°€ê¸€ì¸ ê²½ìš° ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í¼ì„ í‘œì‹œ -->
        <p>ğŸ”’ ì´ ê¸€ì€ ë¹„ë°€ê¸€ì…ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
        <form action="{{ url_for('question.check_password', question_id=question.id) }}" method="POST">
            <input type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
            <button type="submit">í™•ì¸</button>
        </form>
    {% else %}
        <!-- ë¹„ë°€ë²ˆí˜¸ë¥¼ ë§ì¶˜ ê²½ìš° ì œëª©ê³¼ ë‚´ìš© í‘œì‹œ -->
        <h1>{{ question.subject }}</h1> <!-- ì œëª© -->
        <p><strong>ì‘ì„±ì¼:</strong> {{ question.create_date|datetime('%Y-%m-%d %H:%M:%S') }}</p>
        <p><strong>ë‚´ìš©:</strong> {{ question.content }}</p>

        <!-- íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë§í¬ -->
        <h5 class="my-3">ì²¨ë¶€íŒŒì¼</h5>
        {% if files %}
            <ul>
                {% for file in files %}
                    <li><a href="{{ url_for('question.file_download', filename=file.filename) }}" download>{{ file.filename }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            <p>ì²¨ë¶€íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}

        <!-- ìˆ˜ì • í¼ -->
        <form action="{{ url_for('question.update', question_id=question.id) }}" method="POST">
            <div class="form-group">
                <label for="subject_{{ question.id }}">ì œëª©</label>
                <input type="text" id="subject_{{ question.id }}" name="subject" class="form-control" value="{{ question.subject }}" required>
            </div>
            <div class="form-group">
                <label for="content_{{ question.id }}">ë‚´ìš©</label>
                <textarea id="content_{{ question.id }}" name="content" class="form-control" required>{{ question.content }}</textarea>
            </div>
            <div class="d-flex gap-2 mt-3">
                <button type="submit" class="btn btn-primary">ìˆ˜ì •í•˜ê¸°</button>
                <!-- ì‚­ì œ ë²„íŠ¼ -->
                <form action="{{ url_for('question.delete', question_id=question.id) }}" method="POST" onsubmit="return confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                    <button type="submit" class="btn btn-danger mt-2">ì‚­ì œí•˜ê¸°</button>
                </form>
            </div>
        </form>
    {% endif %}

    <a href="{{ url_for('question._list') }}" class="btn btn-secondary mt-3">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>

</div>
{% endblock %}
